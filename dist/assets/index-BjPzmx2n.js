(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();class J{constructor(){this.activeModals=new Map,this.activeTimers=new Map}initialize(n){const r=document.getElementById(n);if(!r)return console.error(`Modal ${n} not found`),null;try{const s=new bootstrap.Modal(r);return this.activeModals.set(n,s),r.addEventListener("hidden.bs.modal",()=>{this.cleanup(n)},{once:!0}),s}catch(s){return console.error(`Failed to initialize modal "${n}": ${s.message}`),null}}show(n,r={}){const s=this.activeModals.get(n)||this.initialize(n);s&&(r.countdown&&this.setupCountdown(n,r.countdown),s.show())}hide(n){const r=this.activeModals.get(n);r&&r.hide()}setupCountdown(n,{duration:r,elementId:s,onComplete:i}){const o=document.getElementById(s);if(!o){console.error(`Countdown element "${s}" not found`);return}let l=r;o.textContent=l;const v=setInterval(()=>{if(l--,o.textContent=l,l<=0&&(this.cleanup(n),this.hide(n),typeof i=="function"))try{i()}catch(m){console.error(`Error in onComplete callback: ${m.message}`)}},1e3);this.activeTimers.set(n,v)}cleanup(n){const r=this.activeTimers.get(n);r&&(clearInterval(r),this.activeTimers.delete(n))}}const h=new J;document.addEventListener("DOMContentLoaded",()=>{typeof AOS<"u"&&AOS.init({duration:800,once:!0});const u=document.getElementById("subscription-form"),n=document.getElementById("form-message"),r=document.getElementById("referral-code"),s=document.getElementById("full-name"),i=document.getElementById("email"),o=document.getElementById("phone"),l=document.getElementById("dob"),v=document.getElementById("gender"),m=document.getElementById("branch"),f=document.getElementById("group"),E=document.getElementById("artist"),p=document.getElementById("payment-type"),O=document.getElementById("installment-options");document.getElementById("payment-methods");const T=document.getElementById("privacy-policy"),U=document.getElementById("subscription-agreement"),g=document.getElementById("submit-btn"),I=g.querySelector(".btn-text"),B=g.querySelector(".spinner-border"),w=document.querySelector(".progress-bar"),N=document.getElementById("country-select");document.getElementById("country"),document.getElementById("currency"),document.getElementById("language");const P=document.getElementById("permit-id"),A=document.getElementById("submission-id"),C=document.getElementById("digital-currency-home-btn");h.show("onboardingModal");const M=[{name:"BigHit Music",groups:["BTS","TXT"]},{name:"PLEDIS Entertainment",groups:["SEVENTEEN","fromis_9"]},{name:"BELIFT LAB",groups:["ENHYPEN","ILLIT"]},{name:"KOZ Entertainment",groups:["ZICO"]},{name:"ADOR",groups:["NewJeans"]},{name:"HYBE Labels Japan",groups:["&TEAM"]}];M.forEach(t=>{const e=document.createElement("option");e.value=t.name,e.textContent=t.name,m.appendChild(e)}),m.addEventListener("change",()=>{const t=M.find(e=>e.name===m.value);f.innerHTML='<option value="" disabled selected>Select a Group</option>',E.innerHTML='<option value="" disabled selected>Select an Artist</option>',t&&t.groups.forEach(e=>{const a=document.createElement("option");a.value=e,a.textContent=e,f.appendChild(a)}),y()}),f.addEventListener("change",()=>{E.innerHTML='<option value="" disabled selected>Select an Artist</option>';const t=f.value,e={BTS:["RM","Jin","SUGA","j-hope","Jimin","V","Jung Kook"],TXT:["SOOBIN","YEONJUN","BEOMGYU","TAEHYUN","HUENINGKAI"],SEVENTEEN:["S.COUPS","JEONGHAN","JOSHUA","JUN","HOSHI","WONWOO","WOOZI","THE 8","MINGYU","DK","SEUNGKWAN","VERNON","DINO"],fromis_9:["LEE SAEROM","SONG HAYOUNG","PARK JIWON","ROH JISUN","LEE SEOYEON","LEE CHAEYOUNG","LEE NAGYUNG","BAEK JIHEON"],ENHYPEN:["JUNGWON","HEESEUNG","JAY","JAKE","SUNGHOON","SUNOO","NI-KI"],ILLIT:["YUNAH","MINJU","MOKA","WONHEE","IROHA"],ZICO:["ZICO"],NewJeans:["MINJI","HANNI","DANIELLE","HAERIN","HYEIN"],"&TEAM":["K","FUMA","NICHOLAS","EJ","YUMA","JO","HARUA","TAKI","MAKI"]};e[t]&&e[t].forEach(a=>{const b=document.createElement("option");b.value=a,b.textContent=a,E.appendChild(b)}),y()});function y(){let e=0;r.value&&e++,s.value&&e++,i.value&&e++,o.value&&e++,document.getElementById("address-line1").value&&e++,document.getElementById("city").value&&e++,document.getElementById("state").value&&e++,document.getElementById("postal-code").value&&e++,N.value&&e++,l.value&&e++,v.value&&e++,m.value&&e++,f.value&&e++,E.value&&e++,p.value&&e++,document.querySelector('input[name="contact-method"]:checked')&&e++;const a=e/14*100;w.style.width=`${a}%`,w.setAttribute("aria-valuenow",a)}p&&O&&p.addEventListener("change",()=>{p.value==="Installment"?(O.classList.remove("d-none"),document.getElementById("installment-plan").required=!0):(O.classList.add("d-none"),document.getElementById("installment-plan").required=!1),document.querySelectorAll('input[name="payment-method"]').forEach(t=>{t.required=!0}),y()}),C&&C.addEventListener("click",()=>{h.hide("digitalCurrencySuccessModal"),window.location.href="https://hybecorp.com"});function Y(){const t=Date.now(),e=Math.floor(Math.random()*1e4);return`HYBE-FP-${t}-${e}`}function d(t,e="info"){n&&(n.className=`mt-3 text-center alert alert-${e} alert-dismissible fade show`,n.textContent=t,n.classList.remove("d-none"),setTimeout(()=>{n.classList.add("d-none")},7e3))}function c(){g&&B&&I&&(g.disabled=!1,B.classList.add("d-none"),I.classList.remove("d-none"))}[r,s,i,o,document.getElementById("address-line1"),document.getElementById("address-line2"),document.getElementById("city"),document.getElementById("state"),document.getElementById("postal-code"),N,l,v,m,f,E,p].forEach(t=>{t&&t.addEventListener("input",y)}),document.querySelectorAll('input[name="contact-method"]').forEach(t=>{t.addEventListener("change",y)}),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(t=>{new bootstrap.Tooltip(t)});let L;window.intlTelInput&&o&&(L=window.intlTelInput(o,{separateDialCode:!0,initialCountry:"auto",geoIpLookup:function(t){fetch("https://ipapi.co/json").then(e=>e.json()).then(e=>t(e.country_code)).catch(()=>t("US"))},utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.1.1/js/utils.js"}),o.addEventListener("input",()=>{L.isValidNumber()?(o.classList.remove("is-invalid"),document.getElementById("phone-error").textContent=""):(o.classList.add("is-invalid"),document.getElementById("phone-error").textContent="Please enter a valid phone number with country code.")}));const x=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;u&&u.addEventListener("submit",async t=>{t.preventDefault(),g&&B&&I&&(g.disabled=!0,B.classList.remove("d-none"),I.classList.add("d-none")),n&&n.classList.add("d-none");try{if(!u.checkValidity()){u.classList.add("was-validated"),d("Please fill out all required fields correctly.","danger"),c();return}if(r.value!=="HYBE2025"){d("Invalid referral code. Use HYBE2025.","danger"),c();return}if(x.test(i.value)?(i.classList.remove("is-invalid"),document.getElementById("email-error").textContent=""):(i.classList.add("is-invalid"),document.getElementById("email-error").textContent="Please enter a valid email address."),!L||!L.isValidNumber()){o.classList.add("is-invalid"),document.getElementById("phone-error").textContent="Please enter a valid phone number with country code.",d("Invalid phone number.","danger"),c();return}else o.classList.remove("is-invalid"),document.getElementById("phone-error").textContent="";const e=new Date(l.value);if(isNaN(e)||l.value!==e.toISOString().split("T")[0]?(l.classList.add("is-invalid"),document.getElementById("dob-error").textContent="Please enter a valid date of birth (YYYY-MM-DD)."):(l.classList.remove("is-invalid"),document.getElementById("dob-error").textContent=""),new Date().getFullYear()-e.getFullYear()<13){d("You must be at least 13 years old to subscribe.","danger"),c();return}if(!T.checked){d("You must agree to the Privacy Policy.","danger"),c();return}if(!U.checked){d("You must agree to complete the subscription.","danger"),c();return}P.value=Y(),A.value=`SUB-${Date.now()}`,h.show("validationModal",{countdown:{duration:5,elementId:"countdown",onComplete:()=>{const S=u.querySelector('input[name="payment-method"]:checked');if(!S){d("Please select a payment method.","danger"),c();return}S.value==="Card Payment"?h.show("paymentModal",{countdown:{duration:5,elementId:"payment-countdown",onComplete:()=>{const H=p.value;H==="Full Payment"?window.location.href="https://buy.stripe.com/14AfZh1LD4eL9Kx0972ZO04":H==="Installment"&&(window.location.href="https://buy.stripe.com/3cIfZhgGxdPlaOBaNL2ZO06")}}}):S.value==="Digital Currency"?(h.show("digitalCurrencySuccessModal"),c()):(d("Selected payment method is not supported.","danger"),c()),console.log(`Subscription submitted: ${A.value}, Artist: ${E.value}, Payment: ${p.value}`)}}})}catch(e){d(`Submission failed: ${e.message}`,"danger"),c()}}),window.addEventListener("error",function(){d("A script error occurred. Please refresh or contact support.","danger")}),window.addEventListener("unhandledrejection",function(){d("A network or script error occurred. Please try again.","danger")}),fetch("https://restcountries.com/v3.1/all").then(t=>t.json()).then(t=>{t.sort((e,a)=>e.name.common.localeCompare(a.name.common)),t.forEach(e=>{const a=document.createElement("option");a.value=e.cca2,a.textContent=e.name.common,N.appendChild(a)})}).catch(()=>{["United States","South Korea","Japan","United Kingdom"].forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,N.appendChild(e)})})});
